{{- range $name, $config := .Values.toolchains }}
{{- if $config.enabled }}
{{- if eq ($config.network.mode | default "nodePort") "hostNetwork" }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "dev-toolchain.configMapName" (dict "root" $ "name" $name) }}
  labels:
    {{- include "dev-toolchain.instanceLabels" (dict "root" $ "name" $name) | nindent 4 }}
data:
  port.conf: |
    # SSH port configuration for hostNetwork mode
    # This file is automatically generated by Helm chart
    Port {{ $config.ports.ssh.nodePort }}
{{- end }}
{{- if $config.userScripts }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "dev-toolchain.deploymentName" (dict "root" $ "name" $name) }}-user-scripts
  labels:
    {{- include "dev-toolchain.instanceLabels" (dict "root" $ "name" $name) | nindent 4 }}
data:
{{- range $scriptName, $scriptContent := $config.userScripts }}
  {{ $scriptName }}: |
{{ $scriptContent | nindent 4 }}
{{- end }}
{{- end }}
{{- end }}
{{- end }}
